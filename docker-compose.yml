version: '3'

services:

  webapp:
    container_name: tax_planner
    labels:
      shipyard.route: '/'
    build: '.'
    environment:
      FLASK_ENV: ${ENVIRONMENT}
      PRIMARY_USER: ${PRIMARY_USER}
      CLIENT_SECRET_FILE: ${CLIENT_SECRET_FILE}
      MASTER_DOC_ID: ${MASTER_DOC_ID}
      MASTER_SPREADSHEET_ID: ${MASTER_SPREADSHEET_ID}
      MASTER_FOLDER_ID: ${MASTER_FOLDER_ID}
      CLIENT_FOLDER_ID: ${CLIENT_FOLDER_ID}
    volumes:
      - './src:/srv/src'
    expose:
      - '8080'

  nginx:
    image: nginx:latest
    container_name: production_nginx
    volumes:
      - './config/nginx.conf:/etc/nginx/nginx.conf'
    ports:
      - '8080:8080'
